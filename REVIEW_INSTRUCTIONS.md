# ⚠️ REVIEW INSTRUCTIONS

> Generated by Gemini

```toml
[review]
summary = "This PR sets up a robust agentic workflow but introduces critical security risks and regressions. The existing application CI pipeline has been deleted, and the new agent configuration grants excessive autonomy for code execution via build tools. Additionally, the dependency on an external repository for syncing executable hooks represents a supply chain vulnerability."
decision = "REQUEST_CHANGES"

[[issues]]
severity = "critical"
file = ".github/workflows/ci.yml"
line = 1
title = "Existing CI/CD pipeline deleted"
description = "The new CI configuration removes `typecheck`, `test`, and `integration` jobs, replacing them with `.claude` config validation. This effectively disables all automated testing for the application code."
suggestion = "Restore the original testing jobs (pytest, mypy, etc.) alongside the new validation steps."

[[issues]]
severity = "critical"
file = ".claude/hooks/auto-approve.sh"
line = 1
title = "Privilege escalation via auto-approved build commands"
description = "The script auto-approves `npm run`, `make`, and other build commands. Since the agent can edit `package.json` or `Makefile`, it can inject malicious commands into these files and then execute them without user confirmation, bypassing the intended safety net."
suggestion = "Remove `npm run`, `make`, and `docker` from the auto-approve allowlist. These commands execute code defined in files the agent can modify."

[[issues]]
severity = "critical"
file = ".github/workflows/sync-claude-config.yml"
line = 1
title = "Supply chain vulnerability via upstream sync"
description = "The workflow automatically fetches executable hooks and workflows from `bigdegenenergy/ai-dev-toolkit`. If that repository is compromised or malicious, it allows remote code execution in this repository."
suggestion = "Remove the automated sync workflow or pin it to a specific trusted commit hash/tag. Ensure strict code review policies are enforced on PRs generated by this workflow."

[[issues]]
severity = "important"
file = ".github/workflows/notify-on-failure.yml"
line = 0
title = "JSON Injection in Slack payload"
description = "The Slack payload is constructed using direct string interpolation of `${{ github.event.workflow_run.head_branch }}`. If the branch name contains quotes, it will break the JSON structure."
suggestion = "Use an environment variable and `jq` to safely construct the JSON payload, similar to how the Discord notification is handled in the same file."

[[issues]]
severity = "important"
file = ".claude/hooks/post-tool-use.sh"
line = 1
title = "Performance and supply chain risk in formatter"
description = "Running `npx prettier --write .` on the entire repository after every tool use is extremely inefficient and will degrade agent performance. Additionally, using `npx` without version pinning downloads the latest package version every time, introducing supply chain risk."
suggestion = "Use `npm exec` to use the project's installed prettier version, and restrict formatting to the specific files changed by the agent (passed as arguments to the hook)."

[[issues]]
severity = "suggestion"
file = ".gitignore"
line = 0
title = "Local settings file should be ignored"
description = "The pattern `!.claude/settings.local.json` un-ignores the local settings file, causing it to be tracked in git. Local settings typically contain machine-specific paths or secrets and should not be committed."
suggestion = "Remove `!.claude/settings.local.json` or change it to ensure the file remains ignored."
```